---
// src/pages/projects.astro — mobile‑first + accessible
import "../styles/global.css";
import { getCollection } from "astro:content";
import ProjectFilter from "../components/ProjectFilter.svelte";

const items = await getCollection("projects");
const B = import.meta.env.BASE_URL;

const projects = items.map((e) => ({
  title: e.data.title,
  href: `${B}projects/${e.slug}`,
  tech: e.data.tech,
  summary: e.data.summary ?? "",
  image: e.data.image ? `${B}${e.data.image}` : `${B}images/projects/${e.slug}.jpg`,
}));

const page = {
  title: "Projects | Sivan Syed",
  description:
    "Selected work across ECE, physics, robotics, and systems — with notes and build details.",
};
---
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>{page.title}</title>
    <meta name="description" content={page.description} />
    <link rel="icon" href={`${B}favicon.svg`} />
    <style>
      @media (prefers-reduced-motion: reduce) { .animate-shimmer { animation: none !important; } }
    </style>
  </head>
  <body class="min-h-screen overflow-x-hidden bg-gradient-to-b from-black via-zinc-950 to-black text-zinc-100 antialiased selection:bg-indigo-500/20 [padding-top:env(safe-area-inset-top)]">
    <a href="#main" class="sr-only focus:not-sr-only focus:fixed focus:left-3 focus:top-3 focus:z-[100] focus:rounded-md focus:bg-zinc-900 focus:px-3 focus:py-2 focus:outline-none">Skip to content</a>

    {/* Decorative */}
    <div aria-hidden class="pointer-events-none fixed inset-0 -z-20">
      <div class="absolute inset-0 [mask-image:radial-gradient(70%_50%_at_50%_0%,black,transparent)]">
        <div class="absolute inset-0 opacity-[0.04] [background-image:linear-gradient(to_right,theme(colors.zinc.400/20)_1px,transparent_1px),linear-gradient(to_bottom,theme(colors.zinc.400/20)_1px,transparent_1px)] [background-size:32px_32px] sm:[background-size:40px_40px] [background-position:center]"></div>
        <div class="absolute -top-24 left-1/2 h-[26rem] w-[48rem] -translate-x-1/2 rounded-full bg-gradient-to-r from-zinc-200/10 via-indigo-400/15 to-zinc-200/10 blur-3xl md:h-[36rem] md:w-[72rem]"></div>
      </div>
    </div>

    {/* Header with mobile menu */}
    <header class="sticky top-0 z-50 border-b border-zinc-800/60 backdrop-blur supports-[backdrop-filter]:bg-zinc-950/55">
      <div class="mx-auto flex max-w-7xl items-center justify-between gap-4 px-4 sm:px-6 md:px-12 lg:px-20 py-3 sm:py-4">
        <a href={`${B}`} class="group flex min-w-0 items-center gap-3">
          <img src={`${B}favicon.svg`} alt="Logo" class="size-9 flex-shrink-0 transition-transform duration-300 group-hover:rotate-6" />
          <div class="min-w-0">
            <h1 class="truncate text-xl font-semibold tracking-tight sm:text-2xl">Sivan Syed</h1>
            <p class="truncate text-[11px] text-zinc-400 sm:text-xs">Physics & ECE • Robotics • Controls • Systems</p>
          </div>
        </a>

        {/* Desktop nav */}
        <nav class="hidden items-center gap-2 text-sm md:flex">
          <a class="navlink" href={`${B}`}>Home</a>
          <a class="navlink" href={`${B}projects`}>Projects</a>
          <a class="navlink" href={`${B}tutoring`}>Tutoring</a>
          <a class="navlink" href={`${B}now`}>Now</a>
          <a class="navlink" href={`/SyedS_ResumeELC_Print.pdf`} target="_blank" rel="noopener noreferrer">Resume</a>
        </nav>

        {/* Mobile menu toggle */}
        <button id="mobile-nav-toggle" aria-controls="mobile-menu" aria-expanded="false" class="inline-flex items-center justify-center rounded-lg border border-zinc-800/60 bg-zinc-900/40 p-2 md:hidden" title="Open menu">
          <span class="sr-only">Open navigation</span>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5"><path d="M3.75 6.75h16.5M3.75 12h16.5M3.75 17.25h16.5"/></svg>
        </button>
      </div>

      {/* Mobile sheet */}
      <div id="mobile-menu" hidden class="md:hidden">
        <div class="mx-auto max-w-7xl px-4 sm:px-6 md:px-12 lg:px-20 pb-3">
          <nav class="grid gap-1 text-sm">
            <a class="navlink w-full" href={`${B}`}>Home</a>
            <a class="navlink w-full" href={`${B}projects`}>Projects</a>
            <a class="navlink w-full" href={`${B}tutoring`}>Tutoring</a>
            <a class="navlink w-full" href={`${B}now`}>Now</a>
            <a class="navlink w-full" href={`/SyedS_ResumeELC_Print.pdf`} target="_blank" rel="noopener noreferrer">Resume</a>
          </nav>
        </div>
      </div>
    </header>

    {/* Main */}
    <main id="main" class="mx-auto max-w-[90rem] px-4 sm:px-6 md:px-12 lg:px-20 py-8 sm:py-10 md:py-14 space-y-16 sm:space-y-20 md:space-y-24 scroll-mt-20">
      {/* Hero */}
      <section class="mx-auto max-w-6xl">
        <p class="text-[11px] uppercase tracking-[0.2em] text-zinc-400/90 sm:text-xs">Projects • Hardware • Software • Theory→Practice</p>
        <h2 class="mt-2 text-3xl font-bold leading-tight sm:text-4xl md:text-5xl">
          <span class="bg-gradient-to-r from-zinc-100 via-zinc-400 to-zinc-100 bg-clip-text text-transparent [text-shadow:0_0_0.5px_rgba(255,255,255,0.35)] animate-shimmer">Selected builds & research</span>
        </h2>
        <p class="mt-3 max-w-3xl text-base text-zinc-300/90 sm:mt-4 sm:text-lg">
          A mix of lab projects, prototypes, and research notes—each card links to a write‑up with diagrams, code, and lessons learned.
        </p>
      </section>

      <hr class="section-divider-glow" />

      {/* Filter */}
      <section class="section">
        <h3 class="section-title">Filter by topic</h3>
        <div class="card">
          <div class="card-border"></div>
          <ProjectFilter client:load projects={projects} baseUrl={B} />
        </div>
      </section>

      <hr class="section-divider-glow" />

      {/* CTA */}
      <section class="section">
        <div class="card">
          <div class="card-border"></div>
          <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
            <div>
              <h3 class="text-lg font-semibold">Want a deep‑dive on a project?</h3>
              <p class="mt-1 text-sm text-zinc-300">I can share design docs, small‑signal derivations, or additional plots on request.</p>
            </div>
            <div class="flex flex-wrap gap-3">
              <a href={`${B}tutoring#contact`} class="btn-ghost">Ask a question</a>
              <a href={`${B}now`} class="btn-primary">See what I'm doing now</a>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="mx-auto max-w-7xl px-4 sm:px-6 md:px-12 lg:px-20 pb-10 pt-6 text-sm text-zinc-500/90">
      <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between border-t border-zinc-800/70 pt-4">
        <p>© {new Date().getFullYear()} Sivan Syed</p>
        <a class="underline decoration-zinc-400/30 underline-offset-2 hover:decoration-zinc-200/60" href={`${B}`}>Back to home</a>
      </div>
    </footer>

    {/* Tiny client script for mobile nav */}
    <script is:inline>
      const btn = document.getElementById('mobile-nav-toggle');
      const menu = document.getElementById('mobile-menu');
      if (btn && menu) {
        btn.addEventListener('click', () => {
          const open = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!open));
          menu.hidden = open;
          btn.innerHTML = !open
            ? `<span class="sr-only">Close navigation</span><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor' class='h-5 w-5'><path d='M6.75 6.75l10.5 10.5M17.25 6.75L6.75 17.25'/></svg>`
            : `<span class="sr-only">Open navigation</span><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor' class='h-5 w-5'><path d='M3.75 6.75h16.5M3.75 12h16.5M3.75 17.25h16.5'/></svg>`;
        });
      }
    </script>
  </body>
</html>
